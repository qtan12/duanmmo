<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MMO Store - Bảo mật tài khoản</title>
    <meta name="description"
        content="Cửa hàng bán tài khoản premium, key license, VPN và các sản phẩm số chất lượng cao với giá tốt nhất.">
    <script type="text/javascript">
        const API_URL = "https://panel.dongnai.net/api/v2/";
    </script>
    <!-- Add Inline Hidden Class for Fix CLS -->
    <style>
        .hidden {
            display: none;
        }
    </style>
    <!-- all css -->
    <link rel="stylesheet" href="assets/css/styles.css" />



    <!-- 1. CAC THU VIEN CAN SU DUNG -->
    <!-- Notification Library -->
    <script src="assets/js/libs/notification.js" defer></script>
    <!-- Initialize FastNotice -->
    <script>
        // Khởi tạo FastNotice với cấu hình tùy chỉnh sau khi DOM sẵn sàng
        document.addEventListener('DOMContentLoaded', function () {
            window.fastNotice = new FastNotice({
                position: 'top-center',    // Vị trí mặc định
                duration: 3000,              // Thời gian hiển thị (ms)
                maxNotifications: 3          // Số notification tối đa
            });
        });
    </script>
    <!-- Lucide Icons - Custom Build -->
    <script src="assets/js/lucide-custom.min.js" defer></script>
    <!-- jModal manager -->
    <script src="assets/js/libs/jmodal.1.1.0.js" defer></script>
    <!-- Load BlazeSlider Library -->
    <script src="assets/js/libs/blaze-slider.js" defer></script>
    <!-- Libs Tabs JS Thuần -->
    <script src="assets/js/libs/tabs.js" defer></script>
    <!-- Image Fallback Utility -->
    <script src="assets/js/libs/image-fallback.js" defer></script>


    <!-- 2. CAC CODE JS TU VIET. -->
    <!-- Cart Manager Libs JS -->
    <script src="assets/js/cart-manager.js" defer></script>
    <!-- Header Component JS. Vi no goi Cart nen nam sau Cart -->
    <script src="assets/js/header.js" defer></script>
    <!-- Security Component JS -->
    <script src="assets/js/security.js" defer></script>

    <!-- Alpine.js CDN. Nam duoi cung vi chay Defer va vi no AutoRun nen can load sau cung truoc -->
    <script src="assets/js/libs/alpinejs.3.15.0.js" defer></script>


</head>

<body class="min-h-screen bg-gray-100">
    <!-- header -->
    <!-- include:./blocks/header.html -->

    <!-- Main Content Area -->
    <main class="sm:container mx-auto py-4 sm:py-8" x-data="securityManager()">
        <div class="mb-8">
            <!-- Header Section -->
            <div class="p-4 mb-6">
                <h1 class="card-title mb-1 sm:mb-2">Bảo mật tài khoản</h1>
                <p class="card-description">Quản lý mật khẩu và cài đặt bảo mật của bạn</p>
            </div>
        </div>

        <!-- Security Content -->
        <div class="max-w-3xl mx-auto space-y-6">
            <!-- Change Password Section -->
            <div class="bg-white rounded-lg shadow-sm p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Đổi mật khẩu</h3>

                <form @submit.prevent="changePassword()" class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Mật khẩu hiện tại</label>
                        <input type="password" x-model="passwordForm.currentPassword"
                            class="w-full input bg-gray-50 text-responsive-sm" placeholder="Nhập mật khẩu hiện tại">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Mật khẩu mới</label>
                        <input type="password" x-model="passwordForm.newPassword"
                            class="w-full input bg-gray-50 text-responsive-sm" placeholder="Nhập mật khẩu mới">
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Xác nhận mật khẩu mới</label>
                        <input type="password" x-model="passwordForm.confirmPassword"
                            class="w-full input bg-gray-50 text-responsive-sm" placeholder="Nhập lại mật khẩu mới">
                    </div>

                    <div class="flex items-center justify-end gap-3 pt-4">
                        <button type="button" @click="resetPasswordForm()" class="btn btn-outline btn-md">
                            <i data-lucide="refresh-cw" class="size-4"></i>
                            Đặt lại
                        </button>
                        <button type="submit" :disabled="isChangingPassword" class="btn btn-primary btn-md">
                            <span x-show="!isChangingPassword" class="flex items-center gap-2">
                                <i data-lucide="lock" class="size-4"></i>
                                Đổi mật khẩu
                            </span>
                            <span x-show="isChangingPassword" class="flex items-center gap-2">
                                <i data-lucide="loader-circle" class="size-4 animate-spin"></i>
                                Đang xử lý...
                            </span>
                        </button>
                    </div>
                </form>
            </div>

            <!-- Security Settings Section -->
            <div class="bg-white rounded-lg shadow-sm p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Cài đặt bảo mật</h3>

                <div class="space-y-4">
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex items-center gap-3">
                            <i data-lucide="smartphone" class="size-5 text-gray-600"></i>
                            <div>
                                <p class="font-medium text-gray-900">Xác thực 2 lớp</p>
                                <p class="text-sm text-gray-500">Bảo vệ tài khoản bằng mã xác thực</p>
                            </div>
                        </div>
                        <button @click="toggle2FA()" class="btn btn-sm btn-outline">
                            <span>Bật ngay</span>
                        </button>
                    </div>

                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex items-center gap-3">
                            <i data-lucide="mail" class="size-5 text-gray-600"></i>
                            <div>
                                <p class="font-medium text-gray-900">Thông báo email</p>
                                <p class="text-sm text-gray-500">Nhận thông báo qua email</p>
                            </div>
                        </div>
                        <button @click="securitySettings.emailNotifications = !securitySettings.emailNotifications"
                            class="btn btn-sm btn-primary">
                            <span>Đã bật</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Active Sessions Section -->
            <div class="bg-white rounded-lg shadow-sm p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900">Phiên đăng nhập hoạt động</h3>
                    <button @click="refreshSessions()" class="btn btn-sm btn-outline">
                        <i data-lucide="refresh-cw" class="size-4"></i>
                        Làm mới
                    </button>
                </div>
                <div class="space-y-3">
                    <div
                        class="flex items-center justify-between p-4 bg-gray-50 rounded-lg border-l-4 border-emerald-500">
                        <div class="flex items-center gap-3 flex-1">
                            <div class="size-10 bg-emerald-100 rounded-lg flex items-center justify-center">
                                <i data-lucide="monitor" class="size-5 text-emerald-600"></i>
                            </div>
                            <div class="flex-1">
                                <p class="text-sm font-medium text-gray-900">Windows 11 • Chrome</p>
                                <p class="text-xs text-gray-500">192.168.1.1 • TP.HCM, Việt Nam</p>
                                <p class="text-xs text-gray-400 mt-1">Đăng nhập lúc: 15:30 hôm nay</p>
                            </div>
                        </div>
                        <span class="badge badge-primary">Phiên hiện tại</span>
                    </div>
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex items-center gap-3 flex-1">
                            <div class="size-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                <i data-lucide="smartphone" class="size-5 text-blue-600"></i>
                            </div>
                            <div class="flex-1">
                                <p class="text-sm font-medium text-gray-900">iOS 17 • Safari</p>
                                <p class="text-xs text-gray-500">192.168.1.2 • TP.HCM, Việt Nam</p>
                                <p class="text-xs text-gray-400 mt-1">Đăng nhập lúc: 10:15 hôm nay</p>
                            </div>
                        </div>
                        <button @click="revokeSession(2)" class="btn btn-sm btn-delete">
                            <i data-lucide="x" class="size-4"></i>
                            Đăng xuất
                        </button>
                    </div>
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex items-center gap-3 flex-1">
                            <div class="size-10 bg-purple-100 rounded-lg flex items-center justify-center">
                                <i data-lucide="tablet" class="size-5 text-purple-600"></i>
                            </div>
                            <div class="flex-1">
                                <p class="text-sm font-medium text-gray-900">Android 13 • Chrome</p>
                                <p class="text-xs text-gray-500">192.168.1.3 • Hà Nội, Việt Nam</p>
                                <p class="text-xs text-gray-400 mt-1">Đăng nhập lúc: Hôm qua 14:20</p>
                            </div>
                        </div>
                        <button @click="revokeSession(3)" class="btn btn-sm btn-delete">
                            <i data-lucide="x" class="size-4"></i>
                            Đăng xuất
                        </button>
                    </div>
                </div>
                <div class="mt-4 pt-4 border-t border-gray-200">
                    <button @click="revokeAllSessions()" class="btn btn-outline w-full">
                        <i data-lucide="log-out" class="size-4"></i>
                        Đăng xuất tất cả các thiết bị khác
                    </button>
                </div>
            </div>

            <!-- Login History Section -->
            <div class="bg-white rounded-lg shadow-sm p-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Lịch sử đăng nhập</h3>
                <div class="space-y-3">
                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                        <div class="size-10 bg-green-100 rounded-lg flex items-center justify-center">
                            <i data-lucide="check-circle" class="size-5 text-green-600"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-900">Đăng nhập thành công</p>
                            <p class="text-xs text-gray-500">Windows 11 • Chrome • 192.168.1.1</p>
                        </div>
                        <span class="text-xs text-gray-400">Hôm nay 15:30</span>
                    </div>
                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                        <div class="size-10 bg-green-100 rounded-lg flex items-center justify-center">
                            <i data-lucide="check-circle" class="size-5 text-green-600"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-900">Đăng nhập thành công</p>
                            <p class="text-xs text-gray-500">iOS 17 • Safari • 192.168.1.2</p>
                        </div>
                        <span class="text-xs text-gray-400">Hôm nay 10:15</span>
                    </div>
                    <div class="flex items-center gap-3 p-3 bg-gray-50 rounded-lg">
                        <div class="size-10 bg-red-100 rounded-lg flex items-center justify-center">
                            <i data-lucide="x-circle" class="size-5 text-red-600"></i>
                        </div>
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-900">Đăng nhập thất bại</p>
                            <p class="text-xs text-gray-500">Mật khẩu không đúng • 192.168.1.100</p>
                        </div>
                        <span class="text-xs text-gray-400">Hôm qua 22:45</span>
                    </div>
                </div>
                <div class="mt-4">
                    <button @click="viewAllHistory()" class="btn btn-outline w-full">
                        Xem tất cả lịch sử
                    </button>
                </div>
            </div>

            <!-- API Keys Section -->
            <div class="bg-white rounded-lg shadow-sm p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900">API Keys</h3>
                    <button @click="createApiKey()" class="btn btn-sm btn-primary">
                        <i data-lucide="plus" class="size-4"></i>
                        Tạo mới
                    </button>
                </div>
                <div class="space-y-3">
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-900 mb-1">Production Key</p>
                            <p class="text-xs text-gray-500 font-mono">sk_live_****_****_****_abcd</p>
                            <p class="text-xs text-gray-400 mt-1">Tạo lúc: 15 tháng 1, 2024</p>
                        </div>
                        <div class="flex items-center gap-2">
                            <button @click="copyApiKey('prod')" class="btn btn-sm btn-outline">
                                <i data-lucide="copy" class="size-4"></i>
                            </button>
                            <button @click="revokeApiKey('prod')" class="btn btn-sm btn-delete">
                                <i data-lucide="trash-2" class="size-4"></i>
                            </button>
                        </div>
                    </div>
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex-1">
                            <p class="text-sm font-medium text-gray-900 mb-1">Test Key</p>
                            <p class="text-xs text-gray-500 font-mono">sk_test_****_****_****_efgh</p>
                            <p class="text-xs text-gray-400 mt-1">Tạo lúc: 10 tháng 1, 2024</p>
                        </div>
                        <div class="flex items-center gap-2">
                            <button @click="copyApiKey('test')" class="btn btn-sm btn-outline">
                                <i data-lucide="copy" class="size-4"></i>
                            </button>
                            <button @click="revokeApiKey('test')" class="btn btn-sm btn-delete">
                                <i data-lucide="trash-2" class="size-4"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Backup Codes Section -->
            <div class="bg-white rounded-lg shadow-sm p-6">
                <div class="flex items-center justify-between mb-4">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-900">Mã dự phòng</h3>
                        <p class="text-sm text-gray-500 mt-1">Sử dụng khi không thể truy cập ứng dụng xác thực</p>
                    </div>
                </div>
                <div class="p-4 bg-yellow-50 border border-yellow-200 rounded-lg mb-4">
                    <div class="flex items-start gap-3">
                        <i data-lucide="alert-triangle" class="size-5 text-yellow-600 flex-shrink-0 mt-0.5"></i>
                        <div>
                            <p class="text-sm font-medium text-yellow-900 mb-1">Lưu ý quan trọng</p>
                            <p class="text-xs text-yellow-700">Vui lòng lưu mã dự phòng ở nơi an toàn. Mỗi mã chỉ sử
                                dụng được một lần.</p>
                        </div>
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-3 mb-4">
                    <div class="p-3 bg-gray-50 rounded-lg font-mono text-sm text-center">A1B2-C3D4</div>
                    <div class="p-3 bg-gray-50 rounded-lg font-mono text-sm text-center">E5F6-G7H8</div>
                    <div class="p-3 bg-gray-50 rounded-lg font-mono text-sm text-center">I9J0-K1L2</div>
                    <div class="p-3 bg-gray-50 rounded-lg font-mono text-sm text-center">M3N4-O5P6</div>
                    <div class="p-3 bg-gray-50 rounded-lg font-mono text-sm text-center">Q7R8-S9T0</div>
                    <div class="p-3 bg-gray-50 rounded-lg font-mono text-sm text-center">U1V2-W3X4</div>
                </div>
                <div class="flex gap-3">
                    <button @click="downloadBackupCodes()" class="btn btn-sm btn-outline flex-1">
                        <i data-lucide="download" class="size-4"></i>
                        Tải xuống
                    </button>
                    <button @click="regenerateBackupCodes()" class="btn btn-sm btn-outline flex-1">
                        <i data-lucide="refresh-cw" class="size-4"></i>
                        Tạo lại
                    </button>
                </div>
            </div>

            <!-- Trusted Devices Section -->
            <div class="bg-white rounded-lg shadow-sm p-6">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-lg font-semibold text-gray-900">Thiết bị tin cậy</h3>
                    <button @click="refreshTrustedDevices()" class="btn btn-sm btn-outline">
                        <i data-lucide="refresh-cw" class="size-4"></i>
                        Làm mới
                    </button>
                </div>
                <div class="space-y-3">
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex items-center gap-3">
                            <div class="size-10 bg-emerald-100 rounded-lg flex items-center justify-center">
                                <i data-lucide="shield-check" class="size-5 text-emerald-600"></i>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-gray-900">MacBook Pro</p>
                                <p class="text-xs text-gray-500">Đã tin cậy từ 15 tháng 1, 2024</p>
                            </div>
                        </div>
                        <button @click="removeTrustedDevice('macbook')" class="btn btn-sm btn-delete">
                            <i data-lucide="x" class="size-4"></i>
                            Gỡ bỏ
                        </button>
                    </div>
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                        <div class="flex items-center gap-3">
                            <div class="size-10 bg-blue-100 rounded-lg flex items-center justify-center">
                                <i data-lucide="smartphone" class="size-5 text-blue-600"></i>
                            </div>
                            <div>
                                <p class="text-sm font-medium text-gray-900">iPhone 14 Pro</p>
                                <p class="text-xs text-gray-500">Đã tin cậy từ 10 tháng 1, 2024</p>
                            </div>
                        </div>
                        <button @click="removeTrustedDevice('iphone')" class="btn btn-sm btn-delete">
                            <i data-lucide="x" class="size-4"></i>
                            Gỡ bỏ
                        </button>
                    </div>
                </div>
                <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
                    <p class="text-xs text-blue-700">
                        <i data-lucide="info" class="size-4 inline mr-1"></i>
                        Thiết bị tin cậy sẽ không yêu cầu xác thực 2 lớp khi đăng nhập từ các thiết bị này.
                    </p>
                </div>
            </div>
        </div>
    </main>
    <!-- Footer -->
    <!-- include:./blocks/footer.html -->
</body>

</html>